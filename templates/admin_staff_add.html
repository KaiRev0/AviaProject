{% extends "base.html" %}

{% block title %}–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞{% endblock %}

{% block content %}
<div class="dashboard admin-dashboard">
    <div class="admin-header-with-actions">
        <h2>‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h2>
        <div class="header-actions">
            <a href="/admin/staff" class="btn back-btn">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
        </div>
    </div>
    
    <div class="edit-form-container">
        <form method="POST" class="edit-form">
            <div class="form-section">
                <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω:*</label>
                        <input type="text" id="phone" name="phone" 
                               placeholder="+7 999 123-45-67" required>
                        <small>–§–æ—Ä–º–∞—Ç: +7XXX –∏–ª–∏ 8XXX</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">–ü–∞—Ä–æ–ª—å:*</label>
                        <input type="password" id="password" name="password" 
                               placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤" required>
                        <small>–ë—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã, –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤</small>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="role">–†–æ–ª—å:*</label>
                        <select id="role" name="role" class="form-control" required
                                onchange="toggleOrganizationField()">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å</option>
                            <option value="admin">üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                            <option value="cashier" selected>üíº –ö–∞—Å—Å–∏—Ä</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="form-section">
                <h3>–ü–∞—Å–ø–æ—Ä—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="passport_series">–°–µ—Ä–∏—è –ø–∞—Å–ø–æ—Ä—Ç–∞:*</label>
                        <input type="text" id="passport_series" name="passport_series" 
                               maxlength="4" placeholder="1234" required>
                        <small>4 —Ü–∏—Ñ—Ä—ã</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="passport_number">–ù–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞:*</label>
                        <input type="text" id="passport_number" name="passport_number" 
                               maxlength="6" placeholder="123456" required>
                        <small>6 —Ü–∏—Ñ—Ä</small>
                    </div>
                </div>
            </div>
            
            <div class="form-section" id="organization-section">
                <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –∫–∞—Å—Å–∏—Ä–∞</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="organization_number">–ù–æ–º–µ—Ä –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:*</label>
                        <input type="text" id="organization_number" name="organization_number" 
                               placeholder="123456789" value="CASH001">
                        <small>5-15 —Ü–∏—Ñ—Ä, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞—Å—Å–∏—Ä–∞</small>
                    </div>
                </div>
            </div>
            
            <div class="info-box">
                <h4>üìù –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>
                <ul>
                    <li>–ü–∞—Ä–æ–ª—å –±—É–¥–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</li>
                    <li>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Å–∏—Å—Ç–µ–º—ã</li>
                    <li>–ö–∞—Å—Å–∏—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ–π—Å—ã –∏ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –±–∏–ª–µ—Ç—ã</li>
                    <li>–í—Å–µ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è</li>
                </ul>
            </div>
            
            <div class="form-buttons">
                <button type="submit" class="btn save-btn">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
                <button type="reset" class="btn reset-btn">–°–±—Ä–æ—Å–∏—Ç—å</button>
                <a href="/admin/staff" class="btn cancel-btn">–û—Ç–º–µ–Ω–∞</a>
            </div>
        </form>
    </div>
</div>

<script>
function toggleOrganizationField() {
    const role = document.getElementById('role').value;
    const orgSection = document.getElementById('organization-section');
    const orgInput = document.getElementById('organization_number');
    
    if (role === 'cashier') {
        orgSection.style.display = 'block';
        orgInput.required = true;
    } else {
        orgSection.style.display = 'none';
        orgInput.required = false;
        orgInput.value = '';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    toggleOrganizationField();
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–∞—Ä–æ–ª—è
    const passwordInput = document.getElementById('password');
    passwordInput.addEventListener('input', function() {
        const password = this.value;
        const hasLetter = /[a-zA-Z]/.test(password);
        const hasDigit = /\d/.test(password);
        const isValid = password.length >= 8 && hasLetter && hasDigit;
        
        if (password.length > 0 && !isValid) {
            this.style.borderColor = '#f44336';
        } else {
            this.style.borderColor = '';
        }
    });
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    const phoneInput = document.getElementById('phone');
    phoneInput.addEventListener('blur', function() {
        const phone = this.value;
        const phoneRegex = /^(\+7|8)[\s\-]?\(?\d{3}\)?[\s\-]?\d{3}[\s\-]?\d{2}[\s\-]?\d{2}$/;
        
        if (phone && !phoneRegex.test(phone)) {
            this.style.borderColor = '#f44336';
        } else {
            this.style.borderColor = '';
        }
    });
});
</script>

<style>
.edit-form-container {
    max-width: 800px;
    margin: 0 auto;
}

.form-section {
    background: white;
    padding: 25px;
    border-radius: 10px;
    margin-bottom: 20px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.05);
    border-left: 4px solid #1976d2;
}

.form-section h3 {
    color: #1976d2;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #e0e0e0;
}

.form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-bottom: 15px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    color: #1565c0;
    font-weight: 500;
}

.form-group input,
.form-group select {
    width: 100%;
    padding: 12px;
    border: 2px solid #bbdefb;
    border-radius: 8px;
    font-size: 16px;
    transition: border-color 0.3s;
}

.form-group input:focus,
.form-group select:focus {
    outline: none;
    border-color: #1976d2;
    box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.1);
}

.form-group small {
    display: block;
    margin-top: 5px;
    color: #666;
    font-size: 12px;
}

.info-box {
    background: #f8fbff;
    padding: 20px;
    border-radius: 10px;
    margin: 25px 0;
    border: 2px dashed #bbdefb;
}

.info-box h4 {
    color: #1976d2;
    margin-bottom: 15px;
}

.info-box ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.info-box li {
    margin: 10px 0;
    padding-left: 25px;
    position: relative;
    color: #555;
}

.info-box li:before {
    content: "‚Ä¢";
    position: absolute;
    left: 10px;
    color: #2196f3;
    font-size: 20px;
}

.form-buttons {
    display: flex;
    gap: 15px;
    margin-top: 30px;
    padding-top: 25px;
    border-top: 1px solid #e0e0e0;
}

.save-btn {
    background: #4caf50 !important;
    flex: 1;
}

.reset-btn {
    background: #bdbdbd !important;
}

.cancel-btn {
    background: #757575 !important;
}

@media (max-width: 768px) {
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .form-buttons {
        flex-direction: column;
    }
}
</style>
{% endblock %}